# Nonparametric Statistics                                         :nonparam:
:PROPERTIES:
:tangle: R/14-nonparam.R
:CUSTOM_ID: cha-Nonparametric-Statistics
:END:

```{r, echo=FALSE, eval=FALSE}
#    IPSUR: Introduction to Probability and Statistics Using R
#    Copyright (C) 2014  G. Jay Kerns
#
#    Chapter: Nonparametric Statistics
#
#    This file is part of IPSUR.
#
#    IPSUR is free software: you can redistribute it and/or modify
#    it under the terms of the GNU General Public License as published by
#    the Free Software Foundation, either version 3 of the License, or
#    (at your option) any later version.
#
#    IPSUR is distributed in the hope that it will be useful,
#    but WITHOUT ANY WARRANTY; without even the implied warranty of
#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#    GNU General Public License for more details.
#
#    You should have received a copy of the GNU General Public License
#    along with IPSUR.  If not, see <http://www.gnu.org/licenses/>.
```

This chapter is still under substantial revision. At any time you can
preview any released drafts with the development version of the
=IPSUR= package which is available from \(\mathsf{R}\)-Forge:

```{r, echo=TRUE, eval=FALSE}
install.packages("IPSUR", repos="http://R-Forge.R-project.org")
library("IPSUR")
read(IPSUR)
```




### How to do it with R

We need data, and for this example we will use the `InsectSprays` data, which lists the `count` of insects in agricultural experimental units treated with six different `spray` insecticides.

```{r}
head(InsectSprays)
```

There are twelve observations per `spray` (small samples) and a `count` variable is certainly nonnormal, though it in principle it could be approximately normal (but in this case isn't).

```{r}
boxplot(count ~ spray, data = InsectSprays, horizontal = TRUE)
```

The data are definitely nonnormal, but unfortunately it is clear that the variances are not the same in each group (recall: we are assuming that the groups differ only in location).  We might try a transformation to stabilize the variance, and the square root is a good guess.

```{r}
boxplot(sqrt(count) ~ spray, data = InsectSprays, horizontal = TRUE)
```

This looks a lot better.  We perform the test with the `kruskal.test` function.  The *p*-value returned is based on the asymptotic chi-squared distribution.

```{r}
kruskal.test(sqrt(count) ~ spray, data = InsectSprays)
```

Here we reject the null hypothesis that all sprays have identical treatment effect on `sqrt(count)`.  

